<h2 mat-dialog-title class="dialog-header">ç¢ºèªè¨‚å–®</h2>

<mat-dialog-content class="dialog-content">
  <div class="info-card">
    <p class="info-row">
      <span class="info-label">è¨‚å–®é¡å‹</span>
      <span class="info-value">{{ data.ordersType }}</span>
    </p>

    @if(data.ordersType === 'A'){
      <p class="info-row">
        <span class="info-label">æ¡Œè™Ÿ</span>
        <span class="info-value highlight">{{ data.tableId }}</span>
      </p>
    } @else if(data.ordersType === 'T'){
      <p class="info-row">
        <span class="info-label">é¡§å®¢å§“å</span>
        <span class="info-value">{{ data.customerName }}</span>
      </p>
      <p class="info-row">
        <span class="info-label">é¡§å®¢é›»è©±</span>
        <span class="info-value">{{ data.customerPhone }}</span>
      </p>
    } @else if(data.ordersType === 'D'){
      <p class="info-row">
        <span class="info-label">é¡§å®¢å§“å</span>
        <span class="info-value">{{ data.customerName }}</span>
      </p>
      <p class="info-row">
        <span class="info-label">é¡§å®¢é›»è©±</span>
        <span class="info-value">{{ data.customerPhone }}</span>
      </p>
      <p class="info-row">
        <span class="info-label">é¡§å®¢åœ°å€</span>
        <span class="info-value">{{ data.customerAddress }}</span>
      </p>
    }
  </div>

  <div class="payment-card">
    <span class="labelCss">ä»˜æ¬¾æ–¹å¼</span>
    <div class="select-wrapper">
      <select [(ngModel)]="paymentType" class="inputCss">
        <option value="ç¾é‡‘">ç¾é‡‘</option>
        <option value="ä¿¡ç”¨å¡">ä¿¡ç”¨å¡</option>
        <option value="é›»å­æ”¯ä»˜">é›»å­æ”¯ä»˜</option>
      </select>
    </div>
  </div>

  <hr class="hidden-divider">

  <h3 class="section-title">ğŸ›’ è¨‚å–®ç´°ç¯€</h3>

  <div class="order-list">
    @for (item of data.orderDetailsList; track item.orderDetailsId) {
      <div class="order-item-card">
        <div class="item-header">
          <span class="type-tag" [class.is-set]="item.settingId > 0">
            @if(item.settingId > 0){ [å¥—é¤] } @else { [å–®é»] }
          </span>

          <div class="qty-price-group">
            <div class="qty-controls">
              <button class="qty-btn" (click)="reduce(item)">-</button>
              <span class="qty-text">{{ item.quantity }}</span>
              <button class="qty-btn" (click)="add(item)">+</button>
            </div>
            <span class="item-total-price">NT$ {{ item.orderDetailsPrice }}</span>
          </div>
        </div>

        @if (item.orderDetails && item.orderDetails.length > 0) {
          @if(item.settingId > 0) {
            <div class="set-content-header">
              {{ item.settingName || 'å¥—é¤' }} å…§å®¹:
            </div>
          }
        }

        <div class="product-details">
          @for (product of item.orderDetails; track product.productId) {
            <div class="product-row">
              <div class="product-name">
                - {{ product.productName }}
                @if(item.settingId > 0){
                  <span class="product-price-sub">(NT$ {{ product.productPrice }})</span>
                }
              </div>

              @if (product.detailList && product.detailList.length > 0) {
                <div class="modifier-box">
                  <span class="modifier-label">å®¢è£½åŒ–:</span>
                  @for(detail of product.detailList; track detail.option) {
                    <span class="modifier-tag">
                      {{ detail.option }} (+NT${{ detail.addPrice }})
                    </span>
                  }
                </div>
              }
            </div>
          }
        </div>
      </div>
    }
  </div>

  <hr class="hidden-divider">

  <div class="total-section">
    <span class="total-label">ç¸½é‡‘é¡ (å°è¨ˆ)</span>
    <span class="total-price">NT$ {{ data.totalPrice }}</span>
  </div>

</mat-dialog-content>

<mat-dialog-actions class="footer-actions">
  <button class="secondary-btn" (click)="addOrder()">åŠ é»</button>
  <button class="primary-btn" (click)="sendOut()">ç«‹åˆ»ä¸‹å–®</button>
</mat-dialog-actions>
